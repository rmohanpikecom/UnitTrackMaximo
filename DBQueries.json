{

  "qryDynWorkOrderGetList": "select hsl_oracletaskid Parent_Task_Id, hsl_workorderid Parent_Task_Number, hsl_businessunitname BusinessUnitName, proj.hsl_oracleid Project_Id, hsl_oracleprojectnumber Project_Number, case when(hsl_subtask=1) then 1 else 0 end Project_SubTask_Flag from [dbo].msdyn_workorder task Inner Join [dbo].[hsl_pikejob] proj on task.hsl_pikejobid=proj.hsl_pikejobid Where hsl_workorderid  in ('20004591-1', '20006489-1', '30746684-2', '34022404-4', '34174936-3', '37882581-2', '39755484-3', '39804424-11', '40897717-9', '41006720-9', '42028292-8', '42120733-3', '42884673-1', '42885051-3', '42962334-4', '43310022-8', '43356336-9', '43404108-3', '43850866-10', '43850866-12', '44031182-8', '44035626-6', '44051027-10', '44133419-8', '44373057-3', '44373144-2', '44373567-2', '44376212-2', '44386238-2', '44386494-2', '44403388-5', '44842910-4', '45039436-2', '45189531-22', '45439485-1', '45611574-3', '45625715-3', '46033727-2', '46053279-1', '46096800-2', '46125295-2', '46131109-1', '46200161-1', '46201866-5', '46240193-6', '46248438-1', '46356622-1', '46371611-2', '46497192-1', '46530604-1', '46666387-1', '46675555-2', '46675863-10', '46756579-2', '46782949-2', '46865373-2', '46883505-2', '46892102-2', '47038519-10', '47070951-3', '47092407-2', '47150471-7', '47185535-5', '47219867-2', '47247392-2', '47268190-10', '47546090-3', '47777882-6', '47800607-1', '47802048-1', '47830629-3', '48150001-2', '48182269-1', '48243088-8', '48319321-2', '48340974-6', '48349174-1', '48355484-2', '48355557-1', '48355930-2', '48370521-3', '48370535-2', '48411278-6', '48529961-1', '48545508-1', '48571309-2', '48624404-7', '48627296-2', '48627453-2', '48634854-2', '48642019-2', '48655453-2', '48755133-2', '48791052-4', '48887750-21', '48900739-1', '48900780-1', '48907301-2', '48937820-2', '48937837-2', '49025811-3', '49122644-2', '49122651-2', '49122652-2', '49187699-6', '49197946-4', '49334360-1', '49334459-2', '49347310-3', '49370596-3', '49373766-8', '49387104-4', '49389683-6', '49392785-5', '49393064-3', '49413479-1', '49491738-6', '49494226-1', '49555520-1', '49566766-10', '49567641-10', '49567772-10', '49568277-10', '49568477-10', '49587834-2', '49597720-2', '49635216-6', '49666071-3', '49727189-4', '49744128-2', '49744421-1', '49789231-10', '49790950-7', '49791079-9', '49883305-7', '49889826-3', '49974530-6', '50003480-10', '50014672-2', '50020573-3', '50026103-4', '50031708-8', '50052577-10', '50078546-10', '50079318-10', '50107740-7', '50108749-7', '50111954-12', '50139002-8', '50139827-7', '50142504-7', '50143474-4', '50154083-5', '50161670-2', '50189358-10', '50199938-10', '50201929-1', '50203777-6', '50217345-11', '50219116-8', '50226848-5', '50228641-3', '50271722-1', '50296852-8', '50301526-8', '50304235-1', '50304821-1', '50356273-10', '50356354-10', '50361647-2', '50387964-10', '50426405-5', '50451042-3', '50485661-1', '50488457-5', '50498333-4', '50507277-1', '50507281-2', '50507287-1', '50507302-3', '50507306-3', '50507323-1', '50507329-2', '50515551-2', '50518155-10', '50548641-3', '50551080-1', '50553090-4', '50583083-1', '50636442-3', '50645445-2', '50647505-7', '50687612-10', '50738663-10', '50756095-10', '50758469-10', '50758570-10', '50758777-10', '50758870-10', '50758999-10', '50759052-7', '50759066-10', '50759592-2', '50772099-2', '50772458-3', '50778295-1', '50779415-3', '50786572-10', '50817594-3', '50818546-2', '50833484-3', '50839683-7', '50850168-2', '50884607-5', '50907542-2', '50907717-2', '50918535-1', '50919743-10', '50925822-10', '50927390-4', '50935579-10', '50936071-10', '50970105-6', '50988149-1', '50991006-10', '51001961-10', '51006177-7', '51007512-1', '51009595-10', '51040849-10', '51041089-10', '51042020-1', '51042836-2', '51058078-10', '51060098-8', '51090603-7', '51093964-4', '51133772-5', '51151047-4', '51154252-10', '51155801-2', '51164463-10', '51169024-10', '51187180-10', '51187401-6', '51188283-10', '51190735-7', '51195511-10', '51195650-10', '51197659-10', '51198170-10', '51198401-10', '51243381-10', '51243620-1', '51243748-10', '51243886-6', '51247556-10', '51267355-4', '51294503-1', '51306135-10', '51321685-3', '51323681-10', '51326328-6', '51328811-2', '51331813-2', '51342993-1', '51343670-1', '51344890-1', '51346798-10', '51347702-10', '51349839-1', '51350762-5', '51363215-3', '51365929-5', '51368488-10', '51391382-2', '51393380-2', '51397301-5', '51397619-6', '51397623-10', '51405637-10', '51410130-3', '51417697-3', '51420745-10', '51421041-7', '51424712-1', '51437761-7', '51453190-10', '51465221-10', '51472028-10', '51473776-2', '51474784-1', '51481013-8', '51482590-10', '51482870-10', '51482998-10', '51483034-10', '51489654-4', '51489654-7', '51489654-9', '51495552-5', '51498068-10', '51499284-2', '51500133-6', '51500195-10', '51500548-10', '51504393-1', '51505624-10', '51506078-10', '51511023-1', '51511358-10', '51511825-10', '51512488-10', '51512750-10', '51519056-2', '51519073-1', '51530025-6', '51530095-10', '51530104-3', '51530606-1', '51530891-2', '51531940-10', '51532024-10', '51532167-10', '51532194-10', '51532300-10', '51533397-5', '51536162-10', '51536187-10', '51538244-10', '51538490-10', '51538706-10', '51538748-10', '51538764-10', '51538784-10', '51545175-10', '51545838-10', '51548206-10', '51550379-6', '51556242-10', '51562034-2', '51563540-10', '51570395-10', '51590146-10', '51595708-10', '51595716-2', '51596037-4', '51598956-2', '51602704-10', '51604417-10', '51605018-10', '51605855-3', '51605870-10', '51605874-2', '51605901-1', '51605905-2', '51606274-10', '51606473-10', '51626599-10', '51630700-10', '51645360-10', '51650530-1', '51650574-1', '51651534-4', '51651879-1', '51653498-10', '51653667-10', '51654060-10', '51654165-10', '51654298-10', '51654367-10', '51659068-1', '51659313-1', '51659528-1', '51665672-3', '51666876-10', '51666952-10', '51667086-10', '51674383-1', '51675165-10', '51694521-6', '51694711-1', '51695675-1', '51698680-10', '51698762-10', '51698860-10', '51699200-5', '51701337-10', '51701389-10', '51701414-10', '51701450-10', '51701634-2', '51701693-10', '51703914-2', '51709703-10', '51710784-7', '51715465-10', '51716101-2', '51717889-10', '51726096-10', '51726175-10', '51726319-10', '51726416-10', '51726457-10', '51727172-10', '51727431-10', '51727608-10', '51727816-10', '51728316-10', '51728641-10', '51729002-10', '51730700-10', '51730732-10', '51732916-10', '51735636-2', '51741848-10', '51742713-10', '51744309-10', '51744346-10', '51750802-10', '51751565-2', '51751611-2', '51751923-10', '51751985-10', '51752312-10', '51752446-10', '51752685-10', '51752955-10', '51753007-10', '51754313-10', '51755367-1', '51759385-1', '51765297-2', '51771796-5', '51774249-10', '51774562-10', '51774754-10', '51790939-3', '51791849-10', '51792289-1', '51792753-2', '51792875-10', '51794157-10', '51796642-10', '51801066-5', '51801611-3', '51801770-10', '51801776-10', '51801916-10', '51802004-10', '51802331-10', '51802690-10', '51802805-10', '51824544-7', '51827147-1', '51827462-2', '51839237-10', '51839281-10', '51841577-10', '51842815-4', '51843642-10', '51845218-1', '51845682-3', '51847366-10', '51848374-1', '51849232-1', '51849690-1', '51849970-10', '51854280-10', '51855273-10', '51855297-10', '51855727-10', '51860685-10', '51867357-10', '51867446-10', '51867454-10', '51867661-10', '51867669-10', '51867675-10', '51867745-10', '51872324-1', '51872549-2', '51872804-8', '51876291-10', '51876393-10', '51876899-10', '51877247-10', '51877500-10', '51878417-1', '51879115-7', '51888701-10', '51891241-5', '51891755-1', '51894050-10', '51894495-10', '51896452-1', '51897577-10', '51897671-10', '51903575-5', '51903823-10', '51903977-10', '51906298-10', '51906646-10', '51907130-2', '51909157-1', '51910384-7', '51918022-10', '51919361-3', '51919597-3', '51922593-3', '51923189-3', '51923839-3', '51925535-2', '51925694-10', '51931510-10', '51931592-10', '51931806-10', '51934082-1', '51935355-10', '51936313-10', '51947923-1', '51963003-1', '51964445-1', '51965791-10', '51967247-10', '51968679-11', '51970510-10', '51974454-11', '51975941-10', '51976499-10', '51976772-10', '51976959-10', '51977274-1', '51978258-10', '51983817-10', '51984223-1', '51984277-10', '51984774-4', '52016767-10', '52018509-10', '52018943-10', '52018953-21', '52020542-3', '52022705-10', '52024403-10', '52025052-10', '52025137-10', '52084562-2', '52086980-11', '52086998-10', '52087398-2', '52091761-8', '52096799-10', '52097165-10', '52097222-10', '52108882-3', '52111134-10', '52132128-10', '52132217-10', '52132335-10', '52133297-2', '52134047-2', '52135550-10', '52136741-1', '52136971-1', '52137161-1', '52143047-10', '52143167-10', '52143350-10', '52143484-10', '52143505-10', '52143930-10', '52144033-10', '52144081-10', '52144254-1', '52144313-10', '52144766-10', '52145066-10', '52145953-6', '52146975-10', '52147678-1', '52152598-2', '52152688-3', '52154265-10', '52154329-10', '52154475-10', '52154568-10', '52156057-10', '52156115-10', '52156368-10', '52156718-2', '52157094-1', '52160064-2', '52160383-2', '52162456-1', '52167177-2', '52167585-2', '52171568-4', '52172296-3', '52172321-10', '52175149-4', '52176232-4', '52176776-3', '52177730-1', '52181736-10', '52181881-1', '52182373-10', '52182579-10', '52182823-3', '52183001-10', '52183152-10', '52183553-2', '52195556-2', '52195944-11', '52196153-10', '52196664-10', '52196728-10', '52199305-1', '52202310-10', '52210944-10', '52211527-2', '52213662-2', '52214110-2', '52215979-10', '52216248-3', '52216526-1', '52218112-1', '52218219-10', '52221005-1', '52221644-10', '52221851-10', '52221859-10', '52222889-10', '52223080-10', '52226522-2', '52227094-10', '52227600-10', '52228278-10', '52232592-2', '52233797-1', '52237688-2', '52238071-1', '52238191-10', '52238199-10', '52238204-10', '52238206-10', '52238238-10', '52238260-10', '52238456-10', '52238918-2', '52238935-10', '52238942-10', '52238958-10', '52239004-10', '52241936-2', '52246684-2', '52247055-2', '52248420-1', '52251116-2', '52254900-2', '52260682-1', '52260802-10', '52261133-2', '52262146-2', '52263326-10', '52264168-10', '52265594-10', '52267539-4', '52267898-4', '52268212-1', '52268395-10', '52268437-8', '52268498-10', '52269641-10', '52273302-2', '52276485-3', '52278660-3', '52279132-2', '52282620-1', '52283761-7', '52284776-1', '52287037-2', '52291803-2', '52293898-1', '52293999-6', '52296122-2', '52296521-2', '52298022-1', '52298656-5', '52299048-2', '52299117-2', '52299236-3', '52299674-2', '52300727-1', '52307500-1', '52308038-1', '52308729-10', '52308777-3', '52309655-2', '52311543-3', '52314078-10', '52314223-1', '52314241-10', '52314245-10', '52317506-10', '52317736-1', '52318119-2', '52318329-2', '52318511-1', '52320092-2', '52320506-2', '52320538-2', '52323594-2', '52327296-1', '52328043-2', '52328415-2', '52329281-1', '52331319-1', '52332847-2', '52334052-1', '52334439-2', '52336925-1', '52337063-2', '52339555-1', '52339709-6', '52339991-8', '52340119-1', '52341667-1', '52342261-1', '52343016-7', '52343490-2', '52343792-1', '52344146-1', '52345010-1', '52346875-2', '52349864-1', '52351420-2', '52352348-2', '52352990-1', '52353943-10', '52356266-10', '52356524-10', '52356872-2', '52357432-2', '52357485-1', '52357529-10', '52357614-2', '52358962-1', '52360460-2', '52362544-10', '52362671-10', '52362688-10', '52365954-1', '52366543-2', '52366554-2', '52367248-10', '52367430-6', '52367666-2', '52368154-3', '52368819-1', '52370452-1', '52374158-1', '52374357-4', '52376318-4', '52376631-1', '52376729-2', '52377614-2', '52378903-2', '52379066-1', '52382863-1', '52382870-10', '52383095-10', '52383191-10', '52383613-1', '52383879-2', '52383977-3', '52384086-2', '52384299-10', '52385369-1', '52385422-1', '52385955-10', '52386073-10', '52386264-10', '52386468-10', '52386743-1', '52386837-10', '52386951-2', '52388042-2', '52388705-1', '52388935-10', '52388971-10', '52389033-10', '52389194-1', '52389849-2', '52394456-1', '52394641-2', '52395520-2', '52397572-3', '52397816-1', '52398611-2', '52398872-2', '52399056-10', '52399157-10', '52399673-1', '52399733-10', '52400089-10', '52400168-10', '52400988-10', '52401556-10', '52403062-1', '52404173-10', '52404278-2', '52404868-1', '52405229-2', '52405714-10', '52406665-1', '52407202-1', '52408397-10', '52408512-10', '52408652-1', '52408682-2', '52408938-10', '52410289-2', '52413371-10', '52413412-10', '52414160-2', '52416029-10', '52418056-1', '52418608-2', '52420445-1', '52420726-1', '52420820-1', '52423161-1', '52423379-1', '52423978-10', '52425617-2', '52426326-1', '52426377-2', '52429869-1', '52431784-1', '52435181-4', '52436641-2', '52440343-2', '52440690-1', '52440970-10', '52441612-1', '52441617-10', '52441885-1', '52444658-1', '52448536-8', '52449160-2', '52449926-2', '52452113-1', '52452946-2', '52454761-1', '52459731-10', '52460313-1', '52463491-10', '52463499-1', '52463794-1', '52464389-10', '52464477-10', '52464491-10', '52464505-10', '52464517-10', '52464531-10', '52464539-10', '52464554-10', '52465948-2', '52466158-10', '52466320-1', '52466841-10', '52467032-2', '52468066-1', '52468139-1', '52468301-10', '52470486-10', '52473697-1', '52473929-1', '52474332-10', '52478668-10', '52479197-10', '52479493-10', '52479777-10', '52479894-10', '52479969-10', '52481190-10', '52481865-10', '52482346-1', '52482352-10', '52482724-10', '52483230-6', '52483640-2', '52484041-10', '52484049-1', '52484162-10', '52484312-10', '52484551-10', '52485049-10', '52486645-2', '52487631-10', '52488641-1', '52489046-10', '52489503-10', '52517288-10', '52517547-10', '52517980-10', '52518045-2', '52518071-2', '52518229-1', '52518302-2', '52518352-10', '52519610-10', '52520919-5', '52521082-10', '52521169-1', '52522858-10', '52524310-10', '52524486-1', '52526470-6', '52527633-10', '52527925-1', '52528318-1', '52529630-1', '52536823-10', '52537377-10', '52537851-2', '52539137-10', '52539434-10', '52539490-10', '52542340-10', '52542527-10', '52543465-10', '52543503-10', '52547836-10', '52549556-2', '52549983-5', '52551881-10', '52553505-1', '52554001-10', '52554601-1', '52554912-1', '52558358-1', '52559097-10', '52562393-4', '52565301-10', '52567485-10', '52567900-1', '52570902-10', '52573164-10', '52573196-10', '52573208-10', '52573642-1', '52573879-10', '52573986-10', '52579273-10', '52582191-10', '52583722-1', '52585217-1', '52586557-1', '52586825-10', '52587170-10', '52587472-10', '52590878-2', '52592592-1', '52592601-10', '52593749-10', '52594421-10', '52602326-10', '52602609-2', '52602727-10', '52602782-1', '52609659-10', '52621894-2', '52624319-2', '52624732-10', '52624775-1', '52627044-1', '52627488-1', '52629278-4', '52630858-10', '52631148-10', '52631558-10', '52635601-10', '52636084-10', '52636181-10', '52636237-10', '52636290-10', '52636668-10', '52636681-10', '52636842-10', '52637317-10', '52647251-10', '52660636-10', '52661351-1', '52672300-10', '52688483-10') ",

  "qryOracleSubTaskData": "SELECT PROJ.SEGMENT1 PROJECT_NUMBER, NVL(PROJ.ATTRIBUTE14,'N') Subtask_Project_Flag, T.WBS_LEVEL, PARENT.PARENT_TASK_NO, T.Task_Number, T.Task_Name, T.Task_Id,  T.Chargeable_Flag, SUBSTR(T.Task_Number,1, INSTR(T.Task_Number, '-' , 1 ) - 1) Crew_Leader FROM pjf_projects_all_B proj JOIN pjf_projects_all_TL pn on proj.project_ID = pn.Project_ID JOIN PJF_PROJECT_CLASSES CLS on PROJ.PROJECT_ID = CLS.PROJECT_ID JOIN PJF_CLASS_CATEGORIES_VL CATID on CLS.CLASS_CATEGORY_ID = CATID.CLASS_CATEGORY_ID AND CATID.CLASS_CATEGORY = 'Line of Business' LEFT join PJF_CLASS_CODES_VL CD ON CD.CLASS_CATEGORY_ID = cls.CLASS_CATEGORY_ID AND CD.CLASS_CODE_ID = CLS.CLASS_CODE_ID JOIN pjf_proj_elements_VL elm on elm.project_id= proj.Project_ID JOIN PJF_TASKS_V t on T.Task_ID = ELM.PROJ_ELEMENT_ID OUTER APPLY (SELECT X.TASK_NUMBER PARENT_TASK_NO, PLANNING_START_DATE PARENT_PLAN_START_DATE FROM PJF_TASKS_V X WHERE X.TASK_ID = case when t.wbs_level = 1 then t.task_id else t.parent_task_id end) PARENT LEFT OUTER JOIN HR_ORGANIZATION_UNITS ORG ON PROJ.CARRYING_OUT_ORGANIZATION_ID= ORG.ORGANIZATION_ID LEFT OUTER JOIN XLE_ENTITY_PROFILES ENT ON PROJ.LEGAL_ENTITY_ID=ENT.LEGAL_ENTITY_ID LEFT OUTER JOIN PJF_WORK_TYPES_VL WTN ON WTN.WORK_TYPE_ID = PROJ.WORK_TYPE_ID LEFT OUTER JOIN HZ_Parties Customer ON Customer.Party_NUMBER = PROJ.ATTRIBUTE3 LEFT OUTER JOIN PJF_PROJECT_TYPES_VL PROJ_TYPE ON PROJ.PROJECT_TYPE_ID = PROJ_TYPE.PROJECT_TYPE_ID WHERE PROJ.SEGMENT1 like @ProjectNumber and T.TASK_NUMBER like '%' || @TaskNumber || '%' and T.WBS_LEVEL = '2' ORDER BY T.Chargeable_Flag DESC, T.Task_Number fetch first 1 row only ",

  "qryOracleNLRData": "SELECT @Project PARAM_PROJ_TO_BILL, @PARENT_TASKNO PARAM_WONO_TO_BILL, @SUBTASK PARAM_SUBTASK_TO_BILL, @SERVICE_ITEM PARAM_Unit_TO_BILL, @Quantity PARAM_Quantity, @EffectiveDate PARAM_WE_Date, 'ERROR CODES->' ERROR_CODES, CASE WHEN TASK.WO_Number IS NULL THEN 'Task Invalid or Not Provided' ELSE '' END ORACLE_TASK_NO, CASE WHEN @SUBTASK IS NULL AND PROJ.ATTRIBUTE14 ='Y' THEN 'Project Requires Billable Subtask Name' WHEN @SUBTASK IS NOT NULL AND PROJ.ATTRIBUTE14 IS NULL THEN 'Project Does Not Require Billable Subtask Name' WHEN @SUBTASK IS NULL AND PROJ.ATTRIBUTE14 IS NULL THEN '' WHEN @SUBTASK IS NOT NULL and PROJ.ATTRIBUTE14 = 'Y' and SUBTASK.ST_WO_Number IS NULL THEN 'N/A' ELSE '' END ORACLE_SUBTASK, CASE WHEN task.WO_Billable IS NULL THEN 'Billable Parent Task Required' WHEN task.WO_Billable = 'N' THEN 'Parent Task Must be Billable=Y' WHEN task.WO_Billable = 'Y' THEN '' ELSE '' END PARENT_BILLABLE_FLAG, CASE WHEN @SUBTASK IS NULL AND PROJ.ATTRIBUTE14 ='Y' THEN 'Project Requires Subtask' WHEN @SUBTASK IS NOT NULL AND PROJ.ATTRIBUTE14 IS NULL THEN 'Project Does Not Require SR' WHEN @SUBTASK IS NULL AND PROJ.ATTRIBUTE14 IS NULL THEN '' WHEN @SUBTASK IS NOT NULL and PROJ.ATTRIBUTE14 = 'Y' and SUBTASK.ST_WO_Number IS NULL THEN 'Subtask Not Found' WHEN @SUBTASK IS NOT NULL and PROJ.ATTRIBUTE14 = 'Y' and SUBTASK.ST_WO_Number IS NOT NULL AND ST_WO_Billable || ST_WO_Chargeable <> 'YY' THEN 'Subtask must be Billable & Chargeable' ELSE '' END SUBTASK_BILLABLE_CHARGEABLE_FLAG, CASE WHEN RATE_SCHD_INFO.UNIT_NAME IS NULL THEN 'Unit Not Found in Rate Schedule' ELSE '' END Rate_Schedul_Error, 'PROJ_TASK DETAILS->' PROJ_TASK_DETAILS, proj.segment1 Project_Number, proj_name.NAME Project_Name, PROJ.ATTRIBUTE14 Subtask_Project, task.WO_Number Parent_WO_Number, task.WO_NAME Parent_WO_Name, task.WO_Billable Parent_Billable, task.WO_Chargeable Parent_Chargeable, SUBTASK.TOP_TASK_ID, ST_WO_Number Subtask_WO_Number, ST_WO_NAME Subtask_WO_NAME, ST_WO_Billable Subtask_WO_BILLABLE, ST_WO_Chargeable Subtask_WO_CHARGEABLE, SUBSTR(ST_WO_NUMBER,1, INSTR(ST_WO_Number, '-' , 1 ) - 1) Crew_Leader, 'RATE SCHEDULE DETAIL->' RATE_SCHEDULE_DETAILS, RATE_SCHD_INFO.EXP_NAME, RATE_SCHD_INFO.rate_schedule_name, RATE_SCHD_INFO.UNIT_NAME, RATE_SCHD_INFO.RATE, RATE_SCHD_INFO.UNIT_OF_MEASURE, RATE_SCHD_INFO.RATE_START_DATE, RATE_SCHD_INFO.RATE_END_DATE, 'FBDI' FBDI_LOADER, SUBSTR(@EffectiveDate,1,10) FBDI_Expenditure_Date, '' FBDI_Person_Name, '' FBDI_Person_Number, '' FBDI_Human_Resource_Assignment, proj_name.NAME FBDI_Project_Name, proj.segment1 FBDI_Project_Number, CASE WHEN PROJ.ATTRIBUTE14 = 'Y' THEN ST_WO_NAME WHEN PROJ.ATTRIBUTE14 IS NULL THEN WO_NAME END FBDI_TASK_NAME, CASE WHEN PROJ.ATTRIBUTE14 = 'Y' THEN ST_WO_NUMBER WHEN PROJ.ATTRIBUTE14 IS NULL THEN WO_NUMBER END FBDI_TASK_NUMBER, RATE_SCHD_INFO.EXP_NAME FBDI_Expenditure_Type, RATE_SCHD_INFO.Expenditure_Org FBDI_Expenditure_Organization, '' FBDI_Contract_Number, '' FBDI_Funding_Source_Number, RATE_SCHD_INFO.UNIT_NAME FBDI_Nonlabor_Resource, RATE_SCHD_INFO.NLR_ORG FBDI_Nonlabor_Resource_Organization, @Quantity FBDI_Quantity, CASE WHEN PROJ.ATTRIBUTE14 = 'Y' THEN ST_WO_WORK_TYPE_NAME WHEN PROJ.ATTRIBUTE14 IS NULL THEN WO_WORK_TYPE_NAME END FBDI_Work_Type , 'Additional Info' Additional_Info, proj.Project_ID ProjID, Rate_schd_info.NLR_ID NlrID, SubTask.ST_WO_TASK_ID TaskID, Existing_NLR.Quantity_Exists ExistingQtyInPPM, Org1.Name Region, Ent1.Name Legal_Entity, ORG2.Name Business_Unit, org2.organization_id Business_Unit_ID, Org1.organization_id Region_ID FROM pjf_projects_all_b proj JOIN pjf_projects_all_tl proj_name ON proj.project_id = proj_name.project_id LEFT OUTER JOIN HR_ORGANIZATION_UNITS ORG1 ON PROJ.CARRYING_OUT_ORGANIZATION_ID= ORG1.ORGANIZATION_ID LEFT OUTER JOIN XLE_ENTITY_PROFILES ENT1 ON PROJ.LEGAL_ENTITY_ID=ENT1.LEGAL_ENTITY_ID LEFT OUTER JOIN HR_ORGANIZATION_UNITS ORG2 ON PROJ.ORG_ID = ORG2.ORGANIZATION_ID JOIN pjb_cntrct_proj_links pc_link ON proj.project_id = pc_link.project_id and pc_link.active_flag = 'Y' and pc_link.version_type = 'C' OUTER APPLY (SELECT Task_Number WO_Number, chargeable_Flag WO_Chargeable, Billable_Flag WO_Billable, TASK_ID WO_TASK_ID, TASK_NAME WO_NAME, tsk.WBS_LEVEL, tsk.PARENT_TASK_ID, WT.Name WO_WORK_TYPE_NAME, CASE WHEN Task_Number IS NULL THEN '' ELSE 'FOUND' END ORACLE_STATUS FROM PJF_TASKS_V tsk left outer join pjf_work_types_tl WT on tsk.work_type_id = WT.work_type_id WHERE tsk.Project_ID = pc_link.project_id and tsk.task_number = @PARENT_TASKNO AND tsk.WBS_LEVEL = 1) Task OUTER APPLY (SELECT Task_Number ST_WO_Number, chargeable_Flag ST_WO_Chargeable, Billable_Flag ST_WO_Billable, TASK_ID ST_WO_TASK_ID, TASK_NAME ST_WO_NAME, WBS_LEVEL, WT.Name ST_WO_WORK_TYPE_NAME, TOP_TASK_ID FROM PJF_TASKS_V subtsk left outer join pjf_work_types_tl WT on subtsk.work_type_id = WT.work_type_id WHERE subtsk.PARENT_TASK_ID = TASK.WO_TASK_ID AND subtsk.task_number = @SUBTASK AND subtsk.WBS_LEVEL <> 1) SUBTASK JOIN okc_k_headers_all_b Chdr on pc_link.contract_id = chdr.id and ((chdr.version_type = 'C' and chdr.sts_code in ( 'ACTIVE')) OR (chdr.version_type = 'A' and chdr.sts_code in ( 'ACTIVE'))) JOIN okc_k_lines_b Cline on cline.CHR_ID= chdr.id AND pc_link.contract_line_id = cline.id and chdr.MAJOR_VERSION = cline.MAJOR_VERSION Cross Apply (SELECT EXP.EXPENDITURE_TYPE_NAME EXP FROM PJB_BILLING_CONTROLS BCTL JOIN PJF_RBS_ELEMENTS ELM ON BCTL.RBS_ELEMENT_ID = ELM.RBS_ELEMENT_ID JOIN PJF_EXP_TYPES_VL EXP ON ELM.EXPENDITURE_TYPE_ID = EXP.EXPENDITURE_TYPE_ID WHERE BCTL.CONTRACT_ID = chdr.id AND BCTL.CONTRACT_LINE_ID = CLINE.ID AND BCTL.MAJOR_VERSION = CLINE.MAJOR_VERSION AND BCTL.ACTIVE_FLAG = 'Y' AND EXP.EXPENDITURE_TYPE_NAME IN ('Unit Production')) EXP JOIN PJB_BILL_PLANS_VL bp on chdr.ID = bp.contract_ID and bp.bill_plan_id = cline.Bill_Plan_ID and bp.major_version = cline.major_version LEFT OUTER JOIN pjf_rate_schedules_tl rhdr ON bp.nl_bill_rate_sch_id = rhdr.rate_schedule_id OUTER APPLY (SELECT rhdr.Rate_Schedule_id, rhdr.RATE_SCHEDULE_NAME RATE_SCHEDULE_NAME, rdtl.Schedule_Line_ID, ExpType_TL.EXPENDITURE_TYPE_NAME EXP_NAME, nlr.nlr_name UNIT_NAME, rdtl.RATE, rdtl.RATE_UNIT UNIT_OF_MEASURE, SUBSTR(rdtl.START_DATE_ACTIVE,1,10) RATE_START_DATE, SUBSTR(rdtl.END_DATE_ACTIVE,1,10) RATE_END_DATE, exporg.name Expenditure_Org, nlr_org.name NLR_Org, rdtl.Non_labor_resource_id NLR_ID FROM pjf_rate_schedules_tl rhdr join pjf_rate_schedule_lines rdtl on rhdr.rate_schedule_id = rdtl.rate_schedule_id Join pjf_non_labor_res_tl nlr on nlr.non_labor_resource_id = rdtl.non_labor_resource_id Join pjf_exp_types_b ExpType_B on ExpType_B.Expenditure_Type_ID = rdtl.EXPENDITURE_TYPE_ID Join pjf_exp_types_tl ExpType_TL on ExpType_TL.expenditure_type_id = ExpType_B.expenditure_type_id and ExpType_TL.Language = 'US' left outer Join pjf_non_labor_res_orgs nlrorg on nlr.non_labor_resource_id = nlrorg.non_labor_resource_id left outer join hr_all_organization_units_tl exporg on proj.carrying_out_organization_id = exporg.organization_id left outer join hr_all_organization_units_tl nlr_org on nlr_org.organization_id = nlrorg.organization_id WHERE bp.nl_bill_rate_sch_id = rhdr.rate_schedule_id AND nlr.nlr_name LIKE '%' || @SERVICE_ITEM || '%' AND (SUBSTR(rdtl.START_DATE_ACTIVE,1,10) <= @EffectiveDate AND SUBSTR(NVL(rdtl.END_DATE_ACTIVE,'2050-01-01'),1,10) >= @EffectiveDate)) RATE_SCHD_INFO OUTER Apply ( Select SUM(EI.Quantity) as Quantity_Exists From pjc_exp_items_all EI Join PJF_TASKS_V T on T.TASK_ID = EI.TASK_ID where EI.Expenditure_Item_Date = @EffectiveDate AND EI.task_id IN (SELECT task_ID FROM PJF_TASKS_V where top_task_id = subtask.top_task_id ) AND EI.project_id = PROJ.Project_ID and EI.Non_labor_resource_id = Rate_schd_info.NLR_ID ) Existing_NLR WHERE proj.segment1 = @Project "


}
